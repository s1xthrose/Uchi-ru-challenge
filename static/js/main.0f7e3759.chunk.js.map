{"version":3,"sources":["utils/constants.js","utils/CatsApi.js","components/NavItem/NavItem.js","components/Nav/Nav.js","components/Header/Header.js","components/LikeButton/LikeButton.js","components/Card/Card.js","components/MoreCatsLoading/MoreCatsLoading.js","components/CardsList/CardsList.js","components/AllCats/AllCats.js","components/NotFound/NotFound.js","components/LikedCats/LikedCats.js","components/App/App.js","utils/customHooks.js","reportWebVitals.js","index.js"],"names":["CATS_API_HEADERS","catsApi","baseUrl","headers","this","_baseURL","_headers","pageCounter","fetch","then","res","status","json","Promise","reject","data","NavItem","activeState","itemText","handleClick","isActive","className","onClick","Nav","handleAllCatsClick","handleLikedCatsClick","location","useLocation","useState","activeAllCatsButton","setActiveAllCatsButton","activeLikedCatsButton","setActiveLikedCatsButton","isButtonActive","useCallback","pathname","useEffect","Header","LikeButton","handleLike","isLiked","isDisabled","isLikedClassName","disabled","Card","cardItem","handleDislike","savedCards","path","setIsLiked","checkLike","likedItem","some","item","id","style","backgroundImage","url","MoreCatsLoading","CardsList","React","forwardRef","ref","allCards","images","map","index","fetching","AllCats","allImages","NotFound","header","description","LikedCats","catData","length","App","history","useHistory","setPath","savedCats","setSavedCats","setIsDisabled","db","Dexie","version","stores","cats","open","catch","err","console","log","dispatch","checkStorage","toArray","initialCats","handleSaveCat","cat","find","newCat","catId","add","handleRemoveCat","delete","useReducer","state","action","type","page","pager","pagerDispatch","concat","allImagesDispatch","bottomBoundaryRef","useRef","getCats","e","scrollRef","scrollObserver","node","IntersectionObserver","entries","forEach","en","intersectionRatio","observe","current","useInfiniteScroll","push","exact","from","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","basename","document","getElementById"],"mappings":"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","file":"static/js/main.0f7e3759.chunk.js","sourcesContent":["const CATS_API_BASEURL = \"https://api.thecatapi.com/v1/images/search\";\n\nconst SECRET_API_KEY='fe7a77c9-2ba0-4e7e-9fc8-f59582c8a99a';\n\nconst CATS_API_LIMIT = 15;\n\nconst CATS_API_HEADERS = {\n  'Accept': 'application/json',\n  'Content-Type': 'application/json',\n  'x-api-key': SECRET_API_KEY\n};\n\nexport { \n  CATS_API_BASEURL,\n  CATS_API_HEADERS,\n  CATS_API_LIMIT\n};","import { CATS_API_BASEURL, CATS_API_HEADERS, CATS_API_LIMIT } from './constants';\n\nclass CatsApi {\n  constructor({baseUrl, headers}){\n    this._baseURL = baseUrl;\n    this._headers = headers;\n  }\n\n  getCats(pageCounter) {\n    return fetch(`${this._baseURL}?limit=${CATS_API_LIMIT}&page=${pageCounter}`, {\n      headers: this._headers\n    })\n    .then((res) => {\n      if(res.status === 200){\n        return res.json();\n      } else {\n        return Promise.reject('При получении данных произошла ошибка');\n      }\n    })\n    .then(data => data);\n  }\n}\n\nconst catsApi = new CatsApi({\n  baseUrl: CATS_API_BASEURL,\n  headers: CATS_API_HEADERS\n});\n\nexport {catsApi};","import React from 'react';\nimport './NavItem.css';\n\nfunction NavItem({\n  activeState,\n  itemText,\n  handleClick\n}){\n\n  const isActive = activeState ? 'nav__item_active' : '';\n\n  return(\n    <button\n      className={`nav__item ${isActive}`}\n      onClick={handleClick}\n    >{itemText}</button>\n  )\n}\n\nexport default NavItem;","import React,  { useState, useEffect, useCallback } from 'react';\nimport {  useLocation } from 'react-router-dom';\nimport './Nav.css';\n\nimport NavItem from '../NavItem/NavItem';\n\nfunction Nav({\n  handleAllCatsClick,\n  handleLikedCatsClick,\n}){\n\n  const location = useLocation();\n\n  // states for navitems\n  const [activeAllCatsButton, setActiveAllCatsButton] = useState(false);\n  const [activeLikedCatsButton, setActiveLikedCatsButton] = useState(false);\n\n  // manage navitem active state with router path\n  const isButtonActive = useCallback(() => {\n\n    switch (location.pathname) {\n      case '/all-cats':\n        setActiveAllCatsButton(true);\n        setActiveLikedCatsButton(false);\n        break;\n      case '/liked-cats':\n        setActiveLikedCatsButton(true);\n        setActiveAllCatsButton(false);\n        break;\n      case '/not-found':\n        setActiveLikedCatsButton(false);\n        setActiveAllCatsButton(false);\n        break;\n      default:\n        setActiveLikedCatsButton(false);\n        setActiveAllCatsButton(false);\n    }\n\n  },[location]);\n\n  // useEffect that checks every changing in isButtonActive callback\n  useEffect(()=>{\n    isButtonActive();\n  }, [isButtonActive]);\n\n  return(\n    <nav className=\"nav\">\n      <NavItem\n        activeState={activeAllCatsButton}\n        handleClick={handleAllCatsClick} \n        itemText=\"Все котики\"\n      />\n      <NavItem\n        activeState={activeLikedCatsButton}\n        handleClick={handleLikedCatsClick} \n        itemText=\"Любимые котики\"\n      />\n    </nav>\n  )\n}\n\nexport default Nav;","import React from 'react';\nimport './Header.css';\nimport Nav from '../Nav/Nav'\n\nfunction Header({\n  handleAllCatsClick, \n  handleLikedCatsClick,\n}){\n  return(\n    <header className=\"header\">\n      <Nav\n        handleAllCatsClick={handleAllCatsClick}\n        handleLikedCatsClick={handleLikedCatsClick}\n      />\n    </header>\n  )\n}\n\nexport default Header;","import React from 'react';\nimport './LikeButton.css';\n\nfunction LikeButton ({\n  handleLike,\n  isLiked,\n  isDisabled\n}) {\n\n  const isLikedClassName = isLiked ? 'like-button_active' : '';\n\n  return(\n    <button \n      className={`like-button ${isLikedClassName}`}\n      onClick={handleLike}\n      disabled={isDisabled ? true : false}\n    ></button>\n  )\n}\n\nexport default LikeButton;","import React, { useState, useCallback, useEffect } from 'react';\nimport './Card.css';\n\nimport LikeButton from '../LikeButton/LikeButton';\n\nfunction Card({\n  cardItem,\n  handleLike,\n  handleDislike,\n  savedCards,\n  path,\n  isDisabled\n}){\n\n  // state for managing likeButton (style);\n  const [isLiked, setIsLiked] = useState(false);\n\n  const likeCat = () => {\n    handleLike(cardItem);\n    setIsLiked(true);\n  }\n\n  const dislikeCat = () => {\n    handleDislike(cardItem);\n    setIsLiked(false);\n   \n  }\n\n  // check that cat has saved\n  const checkLike = useCallback(() => {\n   \n    const likedItem = savedCards.some((item) => item.id === cardItem.id);\n\n    // toggle isLiked state\n    if(likedItem){\n      setIsLiked(true);\n    } else {\n      setIsLiked(false);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [savedCards])\n  \n  const toggleLike = () =>{\n    if(isLiked){\n      dislikeCat();\n    } else {\n      likeCat();\n    }\n  }\n  \n    useEffect(()=> {\n      checkLike();\n    }, [checkLike, path]);\n  \n  return(\n    <li className=\"card\" style={{ backgroundImage:`url(${cardItem.url})` }}>\n      <LikeButton\n        isDisabled={isDisabled}\n        handleLike={toggleLike}\n        isLiked={isLiked}\n      />\n    </li>\n  )\n}\n\nexport default Card;","import React from 'react';\nimport './MoreCatsLoading.css';\n\nfunction MoreCatsLoading(){\n  return(\n    <p className=\"more-cats-loading\">... загружаем еще котиков ...</p>\n  )\n}\n\nexport default MoreCatsLoading;\n","import React from 'react';\nimport './CardsList.css';\n\nimport Card from '../Card/Card';\nimport MoreCatsLoading from '../MoreCatsLoading/MoreCatsLoading';\n\nconst CardsList = React.forwardRef((\n{\n  allCards,\n  handleLike,\n  handleDislike,\n  savedCards,\n  path,\n  isDisabled\n}, ref) => {\n\n  return (\n    <>\n    <ul className=\"card-list\">{\n      allCards.images.map((cardItem, index) => (\n        <Card\n          isDisabled={isDisabled}\n          path={path} \n          key={index}\n          cardItem={cardItem}\n          handleLike={handleLike}\n          handleDislike={handleDislike}\n          savedCards={savedCards}\n        />\n      ))\n      }\n    </ul>\n    { allCards.fetching && (<MoreCatsLoading />)}\n    <div\n      className='card-list__bottom-boundary'\n      ref={ref} \n    />\n    </>\n  )\n} );\n\nexport default CardsList;\n\n","import React from 'react';\nimport './AllCats.css';\n\nimport CardsList from '../CardsList/CardsList';\n\nconst AllCats = React.forwardRef((\n{ allImages,\n  handleLike,\n  handleDislike,\n  savedCards,\n  path,\n  isDisabled\n}, ref ) => {\n  \n  return(\n    <CardsList\n      path={path}\n      handleLike={handleLike}\n      handleDislike={handleDislike} \n      allCards={allImages}\n      ref={ref}\n      savedCards={savedCards}\n      isDisabled={isDisabled}\n    />\n  )\n})\n\nexport default AllCats;","import React from 'react';\nimport './NotFound.css';\n\nfunction NotFound({ header, description }){\n  return(\n    <div className=\"notfound\">\n      <h2 className=\"notfound__heading\">{header}</h2>\n      <p className=\"notfound__paragraph\">{description}</p>\n      <div className=\"notfound__image\"></div>\n    </div>\n  )\n}\n\nexport default NotFound;","import React from 'react';\nimport Card from '../Card/Card';\n\nimport NotFound from '../NotFound/NotFound';\n\nfunction LikedCats ({\n  path,\n  catData,\n  handleLike,\n  handleDislike,\n  savedCards,\n  isDisabled\n}){\n\n  // check if there are no liked cats\n  const hasSavedCats = catData.length > 0 ? true : false;\n\n  return( \n    hasSavedCats ? ( \n      <ul className=\"card-list card-list__liked\">\n        { catData.map((item, index) => (\n          <Card\n            isDisabled={isDisabled}\n            path={path} \n            key={index}\n            cardItem={item}\n            handleLike={handleLike}\n            handleDislike={handleDislike}\n            savedCards={savedCards}\n          />\n        ))}\n      </ul>\n    ) : ( \n      <NotFound \n        header=\"мяу\"\n        description=\"здесь пока нет котиков\"\n      />)\n  )\n}\n\nexport default LikedCats;","import React, { useState, useEffect, useReducer, useRef, useCallback } from 'react';\nimport { Route, Redirect, Switch, useHistory } from 'react-router-dom';\nimport Dexie from 'dexie';\nimport './App.css';\n\nimport { useFetch, useInfiniteScroll } from '../../utils/customHooks';\n\nimport Header from '../Header/Header';\nimport AllCats from '../AllCats/AllCats';\nimport LikedCats from '../LikedCats/LikedCats';\nimport NotFound from '../NotFound/NotFound';\n\nfunction App() {\n\n  // history hook for moving between pages\n  const history = useHistory();\n  const [path, setPath] = useState('/');\n  \n  // state for liked cats\n  const [savedCats, setSavedCats] = useState([]);\n\n  // state for disabling button\n  const [isDisabled, setIsDisabled] = useState(false);\n\n  // create dexie db instance\n  const db = new Dexie(\"savedCatsDB\");\n  \n  // create cats table to store data\n  db.version(1).stores({\n    // define table params \n    cats: \"++id, catId, url\" \n  })\n\n  // catch error if db wouldnt open\n  db.open().catch((err)=> {\n    console.log(err)\n  });\n\n  // func to get saved cats from db\n  const checkStorage = useCallback(()=> {\n    db.cats.toArray()\n    .then((initialCats) => {\n      setSavedCats(initialCats)\n    })\n  \n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [path]);\n\n  const handleSaveCat = (cat) => {\n    setIsDisabled(true);\n    // check that cat hasnt created yet\n    const existedCat = savedCats.find( item => item.id === cat.id);\n    if(!existedCat){\n      // new cat object\n      const newCat = {\n        id: cat.id,\n        catId: cat.id,\n        url: cat.url\n      }\n\n      db.cats.add(newCat)\n      .then(() => {\n        checkStorage();\n        setIsDisabled(false);\n      })\n    }\n    \n  }\n\n  const handleRemoveCat = (cat) => {\n    setIsDisabled(true);\n    // check that cat hasnt removed yet\n    const existedCat = savedCats.find( item => item.id === cat.id);\n    if(existedCat){\n      db.cats.delete(cat.id)\n      .then(() => {\n        checkStorage();\n        setIsDisabled(false);\n      })\n    }\n  }\n\n  const handleAllCatsClick = () => {\n    history.push('/all-cats');\n    setPath('/all-cats');\n  }\n\n  const handleLikedCatsClick = () => {\n    history.push('/liked-cats');\n    setPath('/liked-cats');\n  }\n\n  const imgReducer = (state, action) => {\n    switch (action.type) {\n      case 'STACK_IMAGES':\n        return { ...state, images: state.images.concat(action.images) }\n      case 'FETCHING_IMAGES':\n        return { ...state, fetching: action.fetching }\n      default:\n        return state;\n    }\n  } \n  const pageReducer = (state, action) => {\n    switch (action.type) {\n      case 'NEXT_PAGE':\n        return { ...state, page: state.page + 1 }\n      default:\n        return state;\n    }\n  }\n  \n  // reducers for infinite scroll\n  const [pager, pagerDispatch] = useReducer(pageReducer, { page: 0 }); \n  const [allImages, allImagesDispatch] = useReducer(imgReducer,{ images:[], fetching: true });\n  // ref hook to check scroll bottom\n  const bottomBoundaryRef = useRef(null);\n\n  useFetch(pager, allImagesDispatch);\n  useInfiniteScroll(bottomBoundaryRef, pagerDispatch, path);\n  \n  // check storage to load saved cats\n  useEffect(() => {\n    checkStorage();\n  }, [checkStorage]);\n\n  \n  useEffect(() => {\n    setPath(history.location.pathname);\n  },[history, path]) \n\n  return (\n    <div className=\"app\">\n      <Header\n        handleAllCatsClick={handleAllCatsClick}\n        handleLikedCatsClick={handleLikedCatsClick}\n      />\n      <Switch>\n        <Redirect exact from=\"/\" to=\"/all-cats\" />\n        <Route path=\"/all-cats\">\n          <AllCats\n            path={path} \n            allImages={allImages}\n            ref={bottomBoundaryRef}\n            handleLike={handleSaveCat}\n            handleDislike={handleRemoveCat}\n            savedCards={savedCats}\n            isDisabled={isDisabled}\n          />\n        </Route>\n        <Route path=\"/liked-cats\">\n          <LikedCats\n            path={path} \n            handleLike={handleSaveCat}\n            handleDislike={handleRemoveCat}\n            savedCards={savedCats}\n            catData={savedCats}\n            isDisabled={isDisabled}\n          />\n        </Route>\n        <Route push path=\"/not-found\">\n          <NotFound \n            header=\"404\"\n            description=\"страница не найдена, плак\"\n          />\n        </Route>\n        <Redirect from=\"*\" to=\"/not-found\" />\n      </Switch>\n    </div>\n  );\n}\n\nexport default App;\n","import { useEffect, useCallback } from 'react';\nimport { catsApi } from './CatsApi';\n\nexport const useFetch = (data, dispatch) => {\n  useEffect(() => {\n    dispatch({ type: 'FETCHING_IMAGES', fetching: true });\n    catsApi.getCats(data.page)\n      .then(images => {\n        dispatch({ type: 'STACK_IMAGES', images });\n        dispatch({ type: 'FETCHING_IMAGES', fetching: false });\n      })\n      .catch(e => {\n        dispatch({ type: 'FETCHING_IMAGES', fetching: false });\n        return e;\n      })\n  }, [dispatch, data.page])\n}\n\nexport const useInfiniteScroll = (scrollRef, dispatch, path) => {\n  const scrollObserver = useCallback(\n    node => {\n      new IntersectionObserver(entries => {\n        entries.forEach(en => {\n          if (en.intersectionRatio > 0) {\n            dispatch({ type: 'NEXT_PAGE' });\n          }\n        });\n      }).observe(node);\n    },\n    [dispatch]\n  );\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollObserver(scrollRef.current);\n    }\n  }, [scrollObserver, scrollRef, path]);\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter } from 'react-router-dom';\nimport App from './components/App/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter basename='/'>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}